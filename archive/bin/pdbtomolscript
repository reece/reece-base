#!/usr/local/bin/perl
#$Id: pdbtomolscript.pl,v 1.1 1996/02/03 01:13:20 reece Exp $

($me=$0)=~s,^.*/,,;
$RCSId = join( "", 
			  '$Id: pdbtomolscript.pl,v 1.1 1996/02/03 01:13:20 reece Exp $'
			    =~ m/\$\Id: (.+),v(.+) \$/
			  );
$lastres=1;

while (<>)
{
  #     TER    2795      GLY   342
  if (/^TER...................\s*(\d+)/)
	{
	$numres=$1;
  }
  
  #        HELIX    1 H1  LYS     40  LEU     61  1
  elsif (/^HELIX................(....)........(....)/)
	{
	  push(@ss,"$1 $2 helix");
	}

  #        SHEET    1 S1A 7 HIS   112  VAL   114  0
  elsif (/^SHEET.................(....).......(....)/)
	{
	  push(@ss,"$1 $2 strand");
	}
#SSBOND   1 CYS    129    CYS    340
}

print "
\t! secondary structure molscript commands generated by
\t! $RCSId
\t! from file $ARGV ($numres residues)
";

foreach $ss (sort @ss)
{
  ($ss eq $lastss) && next;
  $lastss=$ss;
  ($start,$end,$struct) = $ss =~ /\s*(\d+)\s+(\d+)\s+(.*)/;
  if ($lastres < $start)
	{
	  printf "\t%-7s from %4d to %4d;\t! coil gap inserted by $me\n",
	    "coil", $lastres, $start;
	}
  printf "\t%-7s from %4d to %4d;\n", $struct, $start, $end;
  $lastres=$end;
}


if ($lastres < $numres)
{
  printf "\t%-7s from %4d to %4d;\t! coil gap inserted by $me\n",
  	"coil", $lastres, $start;
}
